---
tags:
  - interview
  - java
---
### Источники

https://habr.com/ru/articles/719744/
https://javarush.com/groups/posts/2547-iz-8-v-13-polnihy-obzor-versiy-java-chastjh-1

---

### Java 8

##### Functional Interface
Интерфейс, содержащий один нереализованный метод
default и static методы могут быть
Основные функциональные интерфейсы:
* `Predicate` - принимает аргументом некоторое значение `T`, возвращает `boolean`: `boolean someMethod(T t);`
* `Consumer` - принимает аргумент типа `Т`, ничего не возвращает (`void`): `void someMethod(T t);`
* `Supplier` - ничего не принимает на вход, но возвращает некоторое значение `T`: `T someMethod();`
* `Function` - принимает на вход параметр типа `Т`, возвращает значение типа `R`: `R someMethod(T t);`

##### Stream API
Способ обрабатывать структуры данных в функциональном стиле:
```java
Arrays.asList("franz", "ferdinand", "fiel", "vom", "pferd")
	.stream()
    .filter(name -> name.startsWith("f"))
    .map(String::toUpperCase)
    .sorted()
    .forEach(System.out::println);
```

##### foreach
Работает с потоком данных как и stream.

##### Lambda
Блок кода, который можно передать в различные места, исходя из этого он может быть выполнен позже столько раз, сколько потребуется:
```java
Runnable runnable = () -> System.out.println("Hello world!");
```

##### Method reference
Синтаксис, созданный чтобы ссылаться на существующие методы или конструкторы Java-классов или объектов через `::`. Виды:
* Ссылка на конструктор: `SomeObject obj = SomeObject::new`
* Ссылка на статический метод: `SomeObject::someStaticMethod`
* Ссылка на нестатический метод объекта определенного типа: `SomeObject::someMethod`
* Ссылка на обычный (нестатический) метод конкретного объекта: `obj::someMethod`

##### New API
Библиотека для работы с датами и временем - `java.time`:
- `LocalDate` - конкретная дата: `2010-01-09`
- `LocalTime` - время, учитывающее часовой пояс: `19:45:55`
- `LocalDateTime` - `LocalDate` + `LocalTime`: `2020-01-04 15:37:47`
- `ZoneId` - часовые пояса
- `Clock` - позволяет достучаться до текущего времени и даты

##### Optional
Обёртка для значений, может безопасно содержать `null`.

##### Другое
* Повторяющиеся аннотации
* Методы по умолчанию для интерфейсов
* ...

---

### Java 9 - TODO

##### JShell
Интерактивная консоль.

##### Private методы в интерфейсах

##### Модульность ([Jigsaw](http://openjdk.java.net/projects/jigsaw/))

##### Immutable Collection
```java
List someList = List.of("first","second","third");`
```

##### Другое
* расширен Optional (добавлены новые методы)
* появились интерфейсы ProcessHandle для управления действиями операционной системы
* G1 - дефолтный сборщик мусора
* HTTP клиент с поддержкой как HTTP/2 протокола и WebSocket
* расширен Stream
* добавлен фреймворк Reactive Streams API (для реактивного программирования)

---

### Java 10 - TODO

##### var
Помечаем сообщение как var, и компилятор определяет тип сообщения по типу инициализатора, присутствующего справа
```java
var message = "Some message…..";
```

##### JIT-compiler (GraalVM)

##### Параллельный G1
Раньше был однопоточный полный цикл GC, теперь работает со всеми ресурсами, которые мы к нему добавляем (становится многопоточным)

##### Другое
* Вводится чистый интерфейс сборщика мусора (Garbage-Collector Interface). Благодаря этому улучшается изоляция исходного кода от разных сборщиков мусора, давая возможность интегрировать альтернативные сборщики быстро и «безболезненно»
* Объединение исходников JDK в один репозиторий
* Коллекции получили новый метод - `copyOf (Collection)`, который возвращает неизменную копию это коллекции
* `Optional` (и его разновидности) получил новый метод `.orElseThrow()`
* Отныне JVM знают о том, что они запускаются в контейнере Docker, и будут извлекать специфичную для контейнера конфигурацию, а не запрашивать саму операционную систему

---

### Java 11 - TODO

##### var (в лямбде)
```java
Function<String, String> append = (var string) -> string + " Text";
```

##### Z (ZGC)
Новый сборщик мусора, выделяет новую память, но никогда не перезапускает ее

##### Epsilon GC
Сборщик мусора, который обрабатывает выделение памяти, но не реализует какой-либо реальный механизм ее восстановления. Как только доступная куча Java будет исчерпана, JVM закроется.

##### Другое
* `ByteArrayOutputStream` получил метод `void writeBytes(byte [])`, записывающий все байты из аргумента в `OutputStream`
* `FileReader` и `FileWriter` получили новые конструкторы, позволяющие указывать Charset
* `Path` отхватил два новых метода, `of(String, String [])` возвращает `Path` из строкового аргумента пути или последовательности строк, которые при объединении образуют строку пути и `of(URI)` - возвращает Path из URI
* `Pattern` - получил метод `asMatchPredicate()`, который проверяет, соответствует ли заданная строка ввода, заданному шаблону (позволяет ли создать предикат по регулярному выражению, чтобы можно было, например, фильтровать данные в stream)
* `String` отхватил много полезных методов, таких как:
	* `String strip()` - вернёт нам строку, которая является этой строкой, при этом удаляются все пробелы в начале и в конце строки (аналог trim(), но по-другому определяет пробелы)
	* `String stripLeading()` - вернёт нам строку, которая является этой строкой, при этом удаляются все пробелы в начале строки
	* `String stripTrailing()` - вернёт нам строку, которая является этой строкой, при этом удаляются все пробелы в конце строки
	* `Stream lines()` - вернёт нам `Stream` из `String`, извлеченных из этой строки, поделенных разделителями строк
	* `String repeat(int)` - вернёт нам строку, которая представляет собой конкатенацию этой строки, повторяющееся количество раз
	* `boolean isBlank()` - вернёт нам true, если строка пуста или содержит только пробелы, иначе false
* `Thread` - были удалены методы `destroy()` и `stop(Throwable)`
* `Files` получил ряд новых методов:
	* `String readString(Path)` - читает все данные из файла в строку, при этом декодируя из байт в символы с использованием кодировки UTF-8
	* `String readString(Path, Charset)` - так же, как и в методе выше, с разницей в том, что декодирование из байт в символы происходит с использованием указанной Charset
	* `Path writeString (Path, CharSequence, OpenOption [])` - записывает последовательность символов в файл. Символы кодируются в байты, используя кодировку UTF-8
	* `Path writeString(Path, CharSequence,Charset, OpenOption [])` - такой же метод, что и выше, только символы кодируются в байты, используя кодировку, указанную в Charset

---

### Java 12 - TODO

##### Update G1
* Возврат неиспользуемой выделенной памяти
* Прерывание смешанных коллекций, когда время паузы превышено

##### Microbenchmark

##### Shenandoah
Алгоритм сборки мусора (GC), цель которого — гарантировать низкое время отклика (нижний предел — 10-500 мс). Это уменьшает время паузы GC при выполнении работы по очищению одновременно с работающими потоками Java.

##### Improve Switch
* Новый синтаксис устраняет необходимость в операторе break для предотвращения ошибок
* Выражения переключателя больше не проваливаются
* Можно определить несколько констант в одной метке
* default регистр теперь обязателен в выражениях переключателей
* break используется в выражениях Switch для возврата значений из самого регистра (по сути switch может возвращать значения)
```java
var result = switch (someDay) {
  case "M", "W", "F" -> "MWF";
  case "T", "TH", "S" -> "TTS";
  default -> {
      if(someDay.isEmpty())
            break "Please insert a valid day.";
      else
            break "Looks like a Sunday.";
  }
};
```

##### Другое
* `String`:
	* `transform(Function f)` - применяет предоставленную функцию к строке. Результат может не быть строкой.  
	* `indent(int x)` - добавляет x пробелов в строку. Если параметр отрицателен, то это количество начальных пробелов будет удалено(если это возможно).
* `Files` - отхватил такой метод как `mismatch()`, который, в свою очередь, находит и возвращает позицию первого несовпадающего байта в содержимом двух файлов или -1L, если нет несоответствия.
* Появился новый класс - `CompactNumberFormat`, для форматирования десятичного числа в компактной форме. Пример такой компактной формы — 1M вместо 1000000. Таким образом, требуется всего лишь два два вместо девяти символов.
* Существует также новый `enum`, `NumberFormatStyle`, у которого есть два значения - LONG и SHORT.
* `InputStream` получил метод - `skipNBytes(long n)`: пропустить n-ое количество байтов из входного потока.

---

### Java 13 - TODO

##### String
* Text block
```java
String TEXT_BLOCK_JSON = """
{
    "name" : "someName",
    "site" : "https://www.someSite.com/"
}
""";
```
* `stripIndent()` - удаляет случайные пробелы из строки. Это полезно, если вы читаете многострочные строки и хотите применить такое же исключение случайных пробелов, как это происходит с явным объявлением (по сути имитирует компилятор для удаления случайных пробелов);
* `formatted(Object... args )` - аналог `format(String format, Object... arg)`, но для текстовых блоков;
* `translateEscapes()` - возвращает строку с escape-последовательностями (например, \ r), переведенными в соответствующее значение Unicode.

##### Improve Switch
В 12 вы определяете возвращаемые значения с помощью `break`. В 13 возвращаемое значение заменили на `yield`.
```java
var result = switch (someDay) {
  case "M", "W", "F" -> "MWF";
  case "T", "TH", "S" -> "TTS";
  default -> {
      if(someDay.isEmpty())
          yield "Please insert a valid day.";
      else
          yield "Looks like a Sunday.";
  }
};
```

##### Dynamic CDS Archives
CDS - Class-Data Sharing. Позволяет упаковывать набор часто используемых классов в архив, который позже может быть загружен несколькими экземплярами JVM.

##### Update Socket API

##### Memory Return for ZGC

##### Другое
* `javax.security` - добавлено свойство `jdk.sasl.disabledMechanisms` для отключения механизмов SASL.
* `java.nio` - добавлен метод `FileSystems.newFileSystem (Path, Map <String,?>)` - соответственно, для создания нового файла.
* Классы `java.nio` теперь имеют абсолютные (в отличие от относительных) `get` и `set`-методы. Они, как и базовый абстрактный класс `Buffer`, включают метод `slice()` для извлечения части буфера.
* В `javax.xml.parsers` добавлены методы для создания экземпляров фабрик DOM и SAX (с поддержкой пространств имен).
* Поддержка Unicode обновлена ​​до версии 12.1.

---

### Java 14 - TODO

##### Switch выражения (стандарт)

##### Records (Записи - превью)
```java
record Point(int x, int y) { }
```

##### Полезные исключения NullPointerExceptions
Исключения `NullPointerExceptions` описывают, какая именно переменная имела значение NULL.

##### Сопоставление с образцом для InstanceOf (предварительная версия)
```java
if (obj instanceof String s) {
    System.out.println(s.contains("hello"));
}
```

##### Инструмент упаковки (инкубатор)
`jpackage` (инкубатор) позволяет упаковать ваше Java‑приложение в пакеты для конкретной платформы, включая все необходимые зависимости:
* Linux: deb и rpm
* macOS: pkg и dmg
* Windows: msi и exe

##### Сборщики мусора
Сборщик мусора Concurrent Mark Sweep (CMS) был удален, и был добавлен экспериментальный сборщик мусора Z.

---

### Java 15 - TODO

##### Текстовые блоки / многострочные строки (стандарт)

##### Запечатанные (sealed) классы - превью
```java
public abstract sealed class Shape
    permits Circle, Rectangle, Square {...}
```
Хотя класс является `public`, единственными классами, которым разрешено создавать подклассы `Shape`, являются `Circle`, `Rectangle`и `Square`.

##### Записи и сопоставление с образцом
Функции `Records`и `Pattern Matching`из Java 14 (см. выше) все еще находятся на стадии предварительной версии и еще не доработаны.

##### Nashorn Javascript Engine
После того, как движок Nashorn Javascript Engine был объявлен устаревшим в Java 11, он был окончательно удален в JDK 15.

##### ZGC: готов к продакшн
[Z Garbage Collector](https://wiki.openjdk.java.net/display/zgc/Main) больше не обозначен как экспериментальный. Теперь он готов к использованию в продакшн.

---

### Java 16 - TODO

##### Сопоставление с образцом для InstanceOf (стандарт)

##### Каналы сокетов Unix-домена
Можно подключаться к сокетам Unix‑домена (также поддерживаются macOS и Windows (10+).
```java
 socket.connect(UnixDomainSocketAddress.of(
        "/var/run/postgresql/.s.PGSQL.5432"));
```

##### API стороннего компоновщика - превью
Планируемая замена JNI (Java Native Interface), позволяющая выполнять компоновку с нативными библиотеками (например, с библиотеками языка C).

##### Записи и сопоставление с образцом
Обе функции теперь готовы к продакшн и больше не отмечены `in preview`.

##### Запечатанные классы - всё ещё в предварительной версии

---

### Java 17 - TODO

##### Сопоставление шаблонов для switch (предварительная версия)
```java
public String test(Object obj) {
    return switch(obj) {
    case Integer i -> "An integer";
    case String s -> "A string";
    case Cat c -> "A Cat";
    default -> "I don't know what it is";
    };
}
```
Можно передавать объекты в функции переключателя и проверять наличие определенного типа.

##### Запечатанные классы (завершена)

##### API внешних функций и памяти (инкубатор)
Замена нативного интерфейса Java (JNI). Позволяет вызывать нативные функции и обращаться к памяти за пределами JVM. Пока это вызовы на C, но в будущем планируется поддержка дополнительных языков (таких как C++, Fortran).

##### Прекращение поддержки диспетчера безопасности
Начиная с Java 1.0, существовал менеджер безопасности. Теперь он устарел и будет удален в одной из будущих версий.

---

### Java 18 - TODO

##### UTF-8 по умолчанию
Если вы пытались, например, читать файлы без явного указания окончания символов, то в предыдущих версиях Java использовалась кодировка операционной системы (например, UTF-8 в Linux и macOS и Windows-1252 в Windows). В Java 18 она изменилась на UTF-8 по умолчанию.

##### Простой веб-сервер
Java 18 теперь поставляется с простейшим HTTP‑сервером, с которого вы можете начать: `jwebserver`
Подробнее о его возможностях можно узнать [здесь](https://openjdk.org/jeps/408).

##### Другие вещи/инкубационные возможности
Полный список и обзор смотрите в [этой статье](https://www.happycoders.eu/java/java-18-features/).

---

### Java 19 - TODO
Добавлено несколько интересных функций, таких как `Virtual Threads` и новый `Foreign Function & Memory API`, а также структурированный параллелизм и `Vector API`, но все они находятся в режиме предварительного просмотра, поэтому могут быть изменены в следующих релизах.
Если вы хотите узнать об этих функциях и о том, что будет дальше, ознакомьтесь с [этой статьей](https://www.happycoders.eu/java/java-19-features/).

---

[[!Теория для собеседования]]